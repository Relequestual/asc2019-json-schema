import { code } from 'mdx-deck/themes';
import myTheme from './myTheme';

import {
  CodeSurferLayout,
  CodeSurferColumnLayout,
  Code,
  Step,
  github,
} from "code-surfer";
import ContentLayout from './layouts/content';
import { Notes, Invert, Appear, Split } from "mdx-deck";

import basicSchemas from "./schemas/basic";

import mmev1 from "./static/mme-v1.png";
import drafts from "./static/drafts.png";

export const themes = [code, myTheme, github];

# JSON Schema!

<Notes>
  Some content
</Notes>

---

<Invert>

# Validation saves lives

</Invert>

---
# Validation (probably?) saves lives

---
# Validation changes lives
### ~~Validation (probably?) saves lives~~

---
# Story
---
<ContentLayout>

## Matchmaker Exchange API

 - Siloed databases of patient data
   - <small>(including DNA variants)</small>
 - Rare and undiagnosed cases
   - <small>(> 10 per country rare)</small>
 - Complex logal and ethical situation
 - Discover and exchange pateint data

</ContentLayout>

<Notes>
  I'm going to walk through what it might have been like to create a JSON Schema for this API.

  The MME API is a federated search (for similar) and response of potential matches using a patient record.

  Not going to cover the legal, social, or ethical issues. Be assured they were handled properly.

  Today is about the technical.
</Notes>

---
<ContentLayout>

## Matchmaker Exchange API

- Each database holds slightly different data
- Representation of a patient needs to be uniform
- Write specification using words and examples
- Release v1.0!

## Sounds easy, right?

</ContentLayout>

---

<Invert>

# Nope

<img style={{
  maxWidth: '50%'
}} src={mmev1} />

</Invert>

---

# Building a schema

---
<ContentLayout>

## Requirements for queries

- Root object must have a 'patient'
- 'patient' must have either properties `genomicFeatures` or `phenotypicFeatures` or both

</ContentLayout>

---

<CodeSurferLayout theme={github}>
<Code
  lang="json"
  code={basicSchemas['001']}
  title="Matchmaker Query Schema"
/>

<Code
  lang="json"
  code={basicSchemas['002']}
/>

<Code
  lang="json"
  code={basicSchemas['003']}
  focus="1:11"
  subtitle="‚ùå Validation seems to do nothing  ü§∑‚Äç‚ôÇÔ∏è"
/>

<Code
  lang="json"
  code={basicSchemas['003']}
  focus="1:11"
  subtitle="This is a schema. A JSON Schema!"
/>

```diff 2,3,5,6 subtitle="These are known keywords"
```

```diff 4 subtitle="This is an unknown keyword. Unknown keywords are ignored."
```

</CodeSurferLayout>

---

<Invert>

# What's a "schema" anyway?

</Invert>

---

<ContentLayout>

# JSON Schema

<ul>
  <li>A vocabulary that allows you to annotate and validate JSON documents.</li>
<Appear>
  <li>An IETF "personal draft" document specification</li>
  <li>JSON!</li>
  <li>Must be a boolean or an object</li>
  <li>This talk covers draft-7. Not draft-4, not draft-8</li>
</Appear>
</ul>

</ContentLayout>

---

<ContentLayout>

# JSON Schema

- This talk covers draft-7. Not draft-4, not draft-8

  <img style={{
    maxWidth: '90%'
  }} src={drafts} />

</ContentLayout>

---

<ContentLayout style={{'fontSize': '32px'}}>

# Key Concepts

Schema ‚Äúkeywords‚Äù : Object properties that are applied to the instance

Keywords fall under one or both of two categories (mostly):

Assertions : produce a boolean result when applied to an instance
Annotations : attach information to an instance for application use

Root Schema : Schema that is the whole JSON document
Subschemas : A schema as a value of an object or array

Some keywords take a schema as their value
</ContentLayout>

